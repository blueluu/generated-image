# MCP 图片生成器交互式测试工具

这是一个用于测试 MCP 图片生成功能的交互式 Node.js 脚本。

## 功能特性

🎨 **完整的交互式体验**
- 彩色终端输出，用户友好的界面
- 步骤引导，无需记忆复杂命令
- 实时错误提示和状态反馈

🚀 **自动化管理**
- 自动启动和管理 MCP 服务器
- 自动检测并构建项目（如果需要）
- 优雅的错误处理和资源清理

🎯 **多种测试场景**
- 查看可用的图片尺寸预设
- 生成单张自定义图片
- 批量生成多张图片
- 生成响应式图片集（多尺寸）

## 使用方法

### 1. 准备工作

确保你有 ModelScope API Key：
- 访问 [ModelScope](https://modelscope.cn/)
- 注册账号并获取 API Key

### 2. 运行测试脚本

```bash
# 方法一：直接运行
node test-mcp-interactive.js

# 方法二：作为可执行文件运行
./test-mcp-interactive.js
```

### 3. 交互式操作

脚本启动后会：

1. **自动启动 MCP 服务器**
   - 检查项目是否已构建
   - 如果需要，自动运行 `npm run build`
   - 启动 MCP 服务器进程

2. **设置 API Key**
   - 提示输入 ModelScope API Key
   - 验证 API Key 格式

3. **显示主菜单**
   ```
   📋 请选择测试功能:
   1. 查看可用的图片尺寸预设
   2. 生成单张图片
   3. 批量生成图片
   4. 生成响应式图片集
   5. 重新设置 API Key
   0. 退出程序
   ```

## 测试场景详解

### 1. 查看尺寸预设
显示所有可用的预设尺寸，包括：
- `hero-banner`: 1920x600 - 网站首页横幅图片
- `card-image`: 400x300 - 卡片图片
- `thumbnail`: 200x150 - 缩略图
- `avatar`: 100x100 - 头像图片
- `blog-featured`: 800x450 - 博客特色图片
- `product-image`: 500x500 - 产品展示图片
- 等等...

### 2. 生成单张图片
交互式配置单张图片：
- 输入图片描述（支持中文，会自动翻译）
- 选择尺寸方式：预设尺寸或自定义尺寸
- 可选择自定义文件名

示例流程：
```
请输入图片描述: 一只可爱的小猫在花园里玩耍
选择尺寸方式:
1. 使用预设尺寸
2. 自定义尺寸
请选择 (1 或 2): 1
请输入预设名称: card-image
请输入文件名 (可选): cute-cat.jpg
```

### 3. 批量生成图片
一次性生成多张不同的图片：
- 指定生成数量（1-5张）
- 为每张图片单独配置描述、尺寸、文件名
- 一次性提交，批量处理

### 4. 生成响应式图片集
为同一内容生成多种尺寸：
- 输入一个图片描述
- 自动生成三种尺寸：
  - 横幅图 (1920x600)
  - 卡片图 (400x300)
  - 缩略图 (200x150)

## 输出结果

生成的图片会保存在项目根目录的 `generated-images` 文件夹中，脚本会显示具体的保存路径。

## 错误处理

脚本包含完善的错误处理：
- API Key 验证
- 网络连接检查
- MCP 服务器状态监控
- 图片生成失败重试提示

## 退出程序

- 选择菜单中的 `0` 正常退出
- 使用 `Ctrl+C` 强制退出
- 程序会自动清理 MCP 服务器进程

## 技术特性

- **ES6 模块**：使用现代 JavaScript 语法
- **异步处理**：完全基于 Promise/async-await
- **进程管理**：自动管理子进程生命周期
- **彩色输出**：使用 ANSI 颜色代码美化终端输出
- **错误恢复**：智能错误处理和用户提示

## 故障排除

### 常见问题

1. **"MCP 服务器启动失败"**
   - 检查 Node.js 版本（需要支持 ES6 模块）
   - 确保项目依赖已安装：`npm install`

2. **"构建失败"**
   - 检查 TypeScript 配置
   - 手动运行：`npm run build`

3. **"API Key 无效"**
   - 确认 ModelScope API Key 正确
   - 检查网络连接

4. **"图片生成失败"**
   - 检查 API Key 额度
   - 尝试简化图片描述
   - 检查网络连接稳定性

### 调试模式

如果遇到问题，可以查看 MCP 服务器的详细日志输出，脚本会显示所有错误信息。

---

**享受测试过程！** 🎨✨
